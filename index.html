<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>JavaScript PCB solver: (C) Chris Hinsley 2016</title>
		<script type="text/javascript" src="https://d3js.org/d3.v4.min.js"></script>
		<script type="text/javascript" src="dsn2pcb.js"></script>
		<script type="text/javascript" src="view.js"></script>
		<style type="text/css">
			/* No style rules here yet */
		</style>
	</head>
	<body>
		<input type="file" id="files" name="files[]" accept=".dsn" single/><br>
		<label for="border_gap">Border Gap:</label>
		<input id="border_gap" type="number" min="1" max="5" step="1" value ="2"/><br>
		<label for="scale">Scale:</label>
		<input id="scale" type="number" min="1" max="20" step="1" value ="10"/><br>
		<div></div>
	</body>

	<script type="text/javascript">

	//file onload handler
	function handleOnLoad(evt)
	{
		//the onload get a string of the dsn file
		var dsn = evt.target.result;

		//params
		var gap = document.getElementById('border_gap').value;
		var scale = document.getElementById('scale').value;

		var pcb_data = dsn2pcb(dsn, gap);
		view_pcb(pcb_data, scale, 2);
	}

	//file selection handler
	function handleFileSelect(evt)
	{
		//filelist
		var files = evt.target.files;
		var f = files[0];

		//dsn files only.
		if (f.name.match('.*[.]dsn'))
		{
			//file reader
			var reader = new FileReader();

			//onload handler
			reader.onload = handleOnLoad;

			//read the dsn file
			reader.readAsText(f);
		}
	}

	//register file selection handler
	document.getElementById('files').addEventListener('change', handleFileSelect, false);

	</script>
</html>
